{
  "name": "security-audit-mcp",
  "version": "1.0.0",
  "description": "Model Context Protocol server for AI Security Audit Framework",
  "author": "Security Team",
  "license": "MIT",
  "server": {
    "command": "python",
    "args": ["-m", "mcp.server"],
    "env": {
      "MCP_SERVER_NAME": "security-audit",
      "LOG_LEVEL": "INFO"
    }
  },
  "tools": [
    {
      "name": "scan_repository",
      "description": "Scan a git repository for security vulnerabilities",
      "inputSchema": {
        "type": "object",
        "properties": {
          "repository_url": {
            "type": "string",
            "description": "Git repository URL"
          },
          "branch": {
            "type": "string",
            "description": "Branch to scan",
            "default": "main"
          },
          "scan_type": {
            "type": "string",
            "enum": ["quick", "standard", "comprehensive", "hephaestus"],
            "default": "standard"
          }
        },
        "required": ["repository_url"]
      }
    },
    {
      "name": "analyze_vulnerability",
      "description": "Analyze a specific vulnerability in detail",
      "inputSchema": {
        "type": "object",
        "properties": {
          "vulnerability_id": {
            "type": "string",
            "description": "Unique vulnerability identifier"
          },
          "include_remediation": {
            "type": "boolean",
            "default": true
          }
        },
        "required": ["vulnerability_id"]
      }
    },
    {
      "name": "remediate_finding",
      "description": "Apply automated remediation for a security finding",
      "inputSchema": {
        "type": "object",
        "properties": {
          "finding_id": {
            "type": "string",
            "description": "Security finding ID"
          },
          "dry_run": {
            "type": "boolean",
            "description": "Preview changes without applying",
            "default": true
          }
        },
        "required": ["finding_id"]
      }
    },
    {
      "name": "get_scan_status",
      "description": "Get the status of a security scan",
      "inputSchema": {
        "type": "object",
        "properties": {
          "scan_id": {
            "type": "string",
            "description": "Scan identifier"
          }
        },
        "required": ["scan_id"]
      }
    },
    {
      "name": "list_recent_scans",
      "description": "List recent security scans",
      "inputSchema": {
        "type": "object",
        "properties": {
          "limit": {
            "type": "integer",
            "description": "Maximum number of scans to return",
            "default": 10,
            "minimum": 1,
            "maximum": 100
          },
          "status": {
            "type": "string",
            "enum": ["pending", "running", "completed", "failed"],
            "description": "Filter by scan status"
          }
        }
      }
    }
  ],
  "resources": [
    {
      "uri": "security://scans",
      "name": "Security Scans",
      "description": "Access to security scan results and history",
      "mimeType": "application/json"
    },
    {
      "uri": "security://vulnerabilities",
      "name": "Vulnerability Database",
      "description": "Known vulnerabilities and threat intelligence",
      "mimeType": "application/json"
    },
    {
      "uri": "security://remediations",
      "name": "Remediation Library",
      "description": "Automated remediation templates and scripts",
      "mimeType": "application/json"
    },
    {
      "uri": "security://reports",
      "name": "Security Reports",
      "description": "Generated security assessment reports",
      "mimeType": "application/pdf"
    }
  ],
  "capabilities": {
    "streaming": true,
    "cancellation": true,
    "progress": true,
    "tools": true,
    "resources": true
  },
  "configuration": {
    "aws_region": {
      "type": "string",
      "description": "AWS region for API calls",
      "default": "us-east-1"
    },
    "api_endpoint": {
      "type": "string",
      "description": "Security audit API endpoint URL"
    },
    "auth_method": {
      "type": "string",
      "enum": ["iam", "api_key"],
      "default": "iam"
    }
  }
}