{
  "mcpServers": {
    "security-scanner": {
      "command": "python",
      "args": ["-m", "mcp.security-scanner-server"],
      "env": {
        "PYTHONPATH": "${workspaceFolder}",
        "MCP_SERVER_MODE": "stdio"
      },
      "metadata": {
        "name": "Security Scanner MCP Server",
        "version": "1.0.0",
        "description": "MCP server for AI-powered security scanning capabilities",
        "author": "AI Security Team"
      }
    },
    "bedrock-security": {
      "command": "python",
      "args": ["${workspaceFolder}/mcp/bedrock-security-mcp.py"],
      "env": {
        "AWS_REGION": "${AWS_REGION}",
        "MCP_SERVER_MODE": "stdio"
      },
      "metadata": {
        "name": "Bedrock Security MCP Server",
        "version": "1.0.0",
        "description": "MCP server for AWS Bedrock security analysis",
        "author": "AI Security Team"
      }
    }
  },
  "tools": {
    "scan_repository": {
      "description": "Scan a repository for security vulnerabilities",
      "inputSchema": {
        "type": "object",
        "properties": {
          "repository_url": {
            "type": "string",
            "description": "URL of the repository to scan"
          },
          "branch": {
            "type": "string",
            "description": "Branch to scan",
            "default": "main"
          },
          "priority": {
            "type": "string",
            "enum": ["low", "normal", "high", "critical"],
            "default": "normal"
          },
          "agents": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": ["sast", "dependency", "secrets", "iac", "container", "all"]
            },
            "default": ["all"]
          }
        },
        "required": ["repository_url"]
      }
    },
    "get_scan_results": {
      "description": "Retrieve results of a security scan",
      "inputSchema": {
        "type": "object",
        "properties": {
          "scan_id": {
            "type": "string",
            "description": "ID of the scan to retrieve"
          },
          "format": {
            "type": "string",
            "enum": ["json", "sarif", "html"],
            "default": "json"
          }
        },
        "required": ["scan_id"]
      }
    },
    "list_scans": {
      "description": "List recent security scans",
      "inputSchema": {
        "type": "object",
        "properties": {
          "repository_url": {
            "type": "string",
            "description": "Filter by repository URL"
          },
          "status": {
            "type": "string",
            "enum": ["pending", "running", "completed", "failed"],
            "description": "Filter by scan status"
          },
          "limit": {
            "type": "integer",
            "minimum": 1,
            "maximum": 100,
            "default": 10
          }
        }
      }
    },
    "analyze_vulnerability": {
      "description": "Get AI-powered analysis of a specific vulnerability",
      "inputSchema": {
        "type": "object",
        "properties": {
          "finding_id": {
            "type": "string",
            "description": "ID of the vulnerability finding"
          },
          "include_remediation": {
            "type": "boolean",
            "default": true
          },
          "include_business_impact": {
            "type": "boolean",
            "default": true
          }
        },
        "required": ["finding_id"]
      }
    },
    "generate_remediation": {
      "description": "Generate remediation code for vulnerabilities",
      "inputSchema": {
        "type": "object",
        "properties": {
          "scan_id": {
            "type": "string",
            "description": "ID of the scan"
          },
          "finding_ids": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of finding IDs to remediate"
          },
          "auto_apply": {
            "type": "boolean",
            "default": false,
            "description": "Automatically apply remediation (requires confirmation)"
          }
        },
        "required": ["scan_id"]
      }
    },
    "create_security_report": {
      "description": "Generate a comprehensive security report",
      "inputSchema": {
        "type": "object",
        "properties": {
          "scan_ids": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of scan IDs to include in report"
          },
          "format": {
            "type": "string",
            "enum": ["pdf", "html", "markdown"],
            "default": "html"
          },
          "include_charts": {
            "type": "boolean",
            "default": true
          },
          "executive_summary": {
            "type": "boolean",
            "default": true
          }
        },
        "required": ["scan_ids"]
      }
    }
  },
  "resources": {
    "security-policies": {
      "uri": "security://policies",
      "name": "Security Policies",
      "description": "Active security policies and compliance frameworks",
      "mimeType": "application/json"
    },
    "vulnerability-database": {
      "uri": "security://vulnerabilities",
      "name": "Vulnerability Database",
      "description": "Known vulnerabilities and CVE information",
      "mimeType": "application/json"
    },
    "scan-history": {
      "uri": "security://history",
      "name": "Scan History",
      "description": "Historical security scan data and trends",
      "mimeType": "application/json"
    },
    "remediation-templates": {
      "uri": "security://remediations",
      "name": "Remediation Templates",
      "description": "Code templates for common vulnerability fixes",
      "mimeType": "application/json"
    }
  },
  "configuration": {
    "stdio": {
      "transport": "stdio",
      "encoding": "utf-8"
    },
    "sse": {
      "transport": "sse",
      "url": "${MCP_SERVER_URL}",
      "headers": {
        "Authorization": "Bearer ${MCP_API_KEY}"
      }
    },
    "capabilities": {
      "tools": true,
      "resources": true,
      "prompts": false,
      "sampling": false
    }
  }
}